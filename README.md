# 自动配色网站

## 项目简介

这是一个基于图片自动提取颜色的智能配色网站。用户可以上传图片，系统会自动从图片中提取两种主要颜色（深色和浅色），应用莫兰迪色调映射算法，并根据预设的配色规则自动生成右侧的长图预览。网站支持iPhone样机模式和H5长图模式两种预览方式，并提供完整的取色逻辑代码和Palette JSON输出。

## 功能特性

### 1. 图片上传功能
- **点击上传**：点击"选择文件"按钮选择本地图片
- **拖拽上传**：支持将图片直接拖拽到上传区域
- **实时预览**：上传后立即在上传区域显示图片预览
- **格式支持**：支持所有常见图片格式（JPG、PNG、GIF等）

### 2. 智能颜色提取
系统使用Canvas API从上传的图片中提取颜色：

#### 提取流程
1. **像素采样**：将图片绘制到Canvas，读取所有像素的RGB值
2. **颜色量化**：将RGB转换为HSL颜色空间，并对HSL值进行量化以减少颜色数量
3. **占比计算**：统计每种颜色在图片中的占比（ratio）
4. **颜色排序**：按占比从高到低排序，提取占比最大的两种颜色
5. **视觉权重计算**：根据饱和度（S）和明度（L）计算视觉重量得分
   - 得分公式：`(S / 100) * 0.6 + ((100 - L) / 100) * 0.4`
6. **颜色分类**：
   - 得分高的颜色 → 深色（strong/主色）
   - 得分低的颜色 → 浅色（soft/副色）
7. **明度调整**：确保深色明度 < 50，浅色明度 ≥ 50

#### 莫兰迪色调映射
对提取的颜色应用莫兰迪色调映射算法：
- **降低饱和度**：将饱和度降低到15-35%之间，保持柔和感
- **保持明度范围**：
  - 深色：明度保持在30-50之间
  - 浅色：明度保持在50-75之间
- **最终调整**：确保映射后深色仍然是深色，浅色仍然是浅色

### 3. 配色规则应用

#### 固定颜色（永远不变）
- **五个产品卖点序号颜色**：
  - #FA3F3F（红色）
  - #FF8F0A（橙色）
  - #EFDD13（黄色）
  - #9EDC23（绿色）
  - #535ED9（蓝色）
- **六个产品小标题文字**：固定 #555555
- **卡片区域背景**：始终白色
- **标题框文字**：白色（固定）
- **标签文字**：白色（固定）

#### 动态颜色（根据提取的颜色变化）
- **标题框背景**：深色（主色）
- **数值文字**：深色（主色）
- **产品卖点卡片背景**：浅色（副色，调淡15%）
- **产品卖点文字**：深色（主色）
- **三个标签背景**（产卖点签、责任摘要、疾病条款）：深色（主色）
- **浅色背景区域**：浅色（副色，调淡15%）
- **名片头像**：深色（主色）
- **名片文字和图标**：深色（主色）
- **思维导图主节点**：深色（主色）
- **思维导图子节点背景**：浅色（副色，调淡15%）
- **思维导图连接线**：深色（主色）

### 4. 预览模式切换
- **iPhone样机模式**：显示完整的iPhone样机，包括外壳、状态栏、导航栏、内容区域和底部按钮
- **H5长图模式**：去掉样机外壳和固定元素，只显示可滚动的长图内容
- **切换按钮**：位于样机左侧，圆角长方形设计，点击切换预览模式

### 5. 代码输出功能
- **取色逻辑代码**：显示完整的取色逻辑代码，包括原始颜色、处理后颜色、配色应用规则
- **Palette JSON**：输出标准的Palette JSON格式，包含所有颜色信息和用途说明

### 6. 莫兰迪色系展示
- 展示10种色系的莫兰迪颜色，每种色系包含浓色和淡色两种
- 每个颜色块显示色号，根据颜色亮度自动调整文字颜色以确保可读性
- 支持滚动浏览所有颜色

## 页面布局结构

### 整体布局
网站采用三栏布局结构：

```
┌─────────────────────────────────────────────────────────────┐
│                        容器 (container)                       │
│  ┌──────────┐  ┌──────────────┐  ┌──────────┐              │
│  │          │  │              │  │          │              │
│  │ 左侧面板 │  │  中间预览区   │  │ 右侧面板 │              │
│  │          │  │              │  │          │              │
│  │ 413px    │  │  样机/长图   │  │ 275px    │              │
│  │          │  │   + 按钮     │  │          │              │
│  │          │  │              │  │          │              │
│  └──────────┘  └──────────────┘  └──────────┘              │
└─────────────────────────────────────────────────────────────┘
```

### 左侧控制面板 (left-panel)
宽度：413px，高度：812px

#### 1. 标题区域 (title-section)
- **标题**：自动配色 Demo
- **副标题**：上传图片，系统会根据配色规则自动生成右侧长图
- 白色背景，圆角16px

#### 2. 上传图片区域 (upload-section)
- **上传卡片** (upload-card)：
  - 白色背景，圆角16px
  - 内边距：18px 25px 25px
- **上传区域** (upload-area)：
  - 高度：119px
  - 背景色：#ECECEC
  - 圆角：8px
  - 支持拖拽上传，拖拽时显示紫色虚线边框
  - 点击区域也可以选择文件
- **选择文件按钮** (select-btn)：
  - 宽度：100%
  - 高度：39px
  - 背景色：#7948EA（紫色）
  - 白色文字

#### 3. 当前配色显示区域 (color-section)
- **配色卡片** (color-card)：
  - 白色背景，圆角16px
  - 标题：当前配色
- **颜色项** (color-item)：
  - 显示深色（strong）和浅色（soft）
  - 每个颜色项包含：
    - 颜色标签文字
    - 颜色块（color-box）：40px × 40px，圆角4px
    - 颜色代码（color-code）：显示十六进制色号

#### 4. 莫兰迪色系颜色展示区域 (logic-section)
- **逻辑卡片** (logic-card)：
  - 白色背景，圆角16px
  - 标题：莫兰迪色系颜色展示
  - 紫色标题栏（#7948EA）
- **颜色列表** (morandi-colors-list)：
  - 展示20种莫兰迪颜色（10种色系 × 2种深浅）
  - 每个颜色项：
    - 高度：60px
    - 显示颜色块和色号
    - 根据颜色亮度自动调整文字颜色
    - 悬停效果：轻微放大和阴影
  - 支持滚动浏览

### 中间预览区域 (center-panel)
位置：页面中心（绝对定位，上下左右居中）

#### 1. 切换按钮 (view-toggle-btn)
- **位置**：样机左侧，垂直居中
- **样式**：圆角长方形（border-radius: 12px）
- **尺寸**：80px × 120px
- **结构**：
  - 上部分：iPhone按钮
  - 下部分：H5长图按钮
- **状态**：
  - 选中：紫色背景（#7948EA），白色文字
  - 未选中：白色背景，灰色文字（#666666）
  - 悬停：浅灰色背景（#F5F5F5）

#### 2. iPhone样机模式 (phone-mockup)
- **样机外壳**：
  - 宽度：375px，高度：812px
  - 黑色背景，圆角40px
  - 内边距：4px
  - 顶部：灵动岛样式（126px × 37px）
  - 底部：Home指示条（134px × 5px）
  - 阴影效果

- **手机屏幕** (phone-screen)：
  - 渐变背景（紫色渐变）
  - 圆角：36px
  - 包含以下部分：
    - **状态栏** (phone-status-bar)：高度44px，显示时间、信号、WiFi、电池图标
    - **导航栏** (phone-navbar)：高度50px，显示返回按钮、标题"责任图解"、小程序标识
    - **内容区域** (phone-content-wrapper)：可滚动区域，包含长图
    - **底部按钮** (phone-footer)：高度82px，显示"设置并转发"按钮

#### 3. H5长图模式 (h5-long-image-container)
- **容器**：
  - 宽度：375px
  - 最大高度：812px
  - 白色背景
  - 可滚动，隐藏滚动条
- **内容**：与iPhone模式中的长图内容完全一致，但不包含状态栏、导航栏和底部按钮

### 右侧代码卡片区域 (right-panel)
宽度：275px（左侧面板的2/3），高度：812px

#### 1. 取色逻辑卡片 (code-card-large)
- **高度**：较高（flex: 1.5）
- **标题**：取色逻辑
- **内容**：显示完整的取色逻辑代码
  - 提取的原始颜色信息
  - 处理后的最终颜色
  - 配色逻辑应用规则
  - 固定颜色说明

#### 2. Palette JSON 例子卡片 (code-card-small)
- **高度**：较低（flex: 1）
- **标题**：Palette JSON 例子
- **内容**：显示Palette JSON格式的配色方案
  - strong（深色）信息
  - soft（浅色）信息
  - lightenedSoft（调淡后的浅色）信息
  - fixed（固定颜色）信息

## 长图内容结构

### 1. 主题图片区域 (theme-image-container)
- **比例**：16:9
- **高度**：通过padding-bottom: 56.25%实现
- **背景色**：#898989（未上传图片时）
- **图片显示**：object-fit: cover，覆盖整个区域

### 2. 标题框 (title-box)
- **位置**：主题图片和副标题之间，使用负边距实现重叠效果
- **样式**：
  - 圆角：8px
  - 内边距：13px 20px
  - 外边距：0 31px，margin-top: -25px
  - 背景色：深色（主色）
  - 文字：白色，18px，不换行

### 3. 副标题区域 (subtitle-section)
- **背景色**：白色
- **内边距**：20px 0，padding-top: 40px
- **内容**：6个副标题项，每个包含标签和数值
- **文字颜色**：标签固定#555555，数值使用深色（主色）

### 4. 浅色背景区域 (light-background-section)
- **背景色**：浅色（副色，调淡15%）
- **最小高度**：960px
- **包含内容**：
  - 产品卖点卡片
  - 责任摘要-脑图
  - 疾病条款
  - 名片信息

### 5. 产品卖点卡片 (selling-points-section)
- **标签**：产卖点签（深色背景，白色文字）
- **内容**：5个卖点卡片
  - 背景色：浅色（副色，调淡15%）
  - 文字颜色：深色（主色）
  - 序号颜色：固定不变（5种颜色）

### 6. 责任摘要-脑图 (summary-section)
- **标签**：责任摘要（深色背景，白色文字）
- **思维导图**：
  - 中心节点：深色（主色）背景，白色文字
  - 子节点：浅色（副色，调淡15%）背景，深色（主色）文字
  - 连接线：深色（主色）
  - 根据Figma设计精确还原样式

### 7. 疾病条款 (terms-section)
- **标签**：疾病条款（深色背景，白色文字）
- **内容**：条款列表

### 8. 名片信息 (card-section)
- **头像**：68px × 68px，深色（主色）背景
- **信息**：
  - 姓名：深色（主色）文字
  - 角色：深色（主色）文字，带图标
  - 电话：深色（主色）文字，带图标
- **二维码**：50px × 50px，占位二维码图案

## 样式说明

### 颜色系统
- **主色调**：#7948EA（紫色）- 用于按钮、标题栏等
- **背景色**：#D9D9D9（浅灰色）- 页面背景
- **卡片背景**：#FFFFFF（白色）
- **文字颜色**：
  - 主要文字：#000000（黑色）
  - 次要文字：#555555（深灰色）
  - 占位文字：rgba(85, 85, 85, 0.33)（半透明灰色）

### 圆角规范
- **大圆角**：16px - 卡片、标题区域
- **中圆角**：8px - 上传区域、按钮、标题框
- **小圆角**：4px - 颜色块、头像
- **按钮圆角**：12px - 切换按钮

### 间距规范
- **卡片间距**：20px
- **内容内边距**：18px - 25px
- **元素间距**：根据设计调整

### 字体规范
- **标题**：20px，加粗
- **正文**：14px - 16px
- **小字**：12px - 13px
- **代码**：12px，等宽字体（Consolas, Monaco, Courier New）

### 阴影效果
- **卡片阴影**：0 2px 8px rgba(0, 0, 0, 0.1)
- **样机阴影**：0 20px 60px rgba(0, 0, 0, 0.3)
- **按钮阴影**：0 2px 8px rgba(0, 0, 0, 0.1)

## 技术实现

### 核心技术栈
- **HTML5**：语义化标签，结构清晰
- **CSS3**：
  - Flexbox布局
  - 绝对定位居中
  - CSS变量（可扩展）
  - 自定义滚动条样式
- **JavaScript (ES6+)**：
  - Canvas API进行图片处理
  - FileReader API读取文件
  - DOM操作和事件处理
  - 颜色空间转换算法

### 关键算法

#### 1. RGB转HSL
```javascript
function rgbToHsl(r, g, b) {
    // 归一化RGB值到0-1
    // 计算最大值和最小值
    // 计算明度L
    // 计算饱和度S
    // 计算色相H
    // 返回HSL对象
}
```

#### 2. HSL转RGB
```javascript
function hslToRgb(h, s, l) {
    // 归一化HSL值
    // 根据饱和度是否为0判断
    // 使用色相转换公式计算RGB
    // 返回RGB对象
}
```

#### 3. 莫兰迪色调映射
```javascript
function applyMorandiMapping(color) {
    // 转换为HSL
    // 降低饱和度到15-35%
    // 调整明度范围
    // 转换回RGB
}
```

#### 4. 颜色调淡
```javascript
function lightenColor(hexColor, lightenAmount = 20) {
    // 转换为RGB
    // 转换为HSL
    // 增加明度
    // 转换回十六进制
}
```

### 文件结构
```
figma/
├── index.html          # 主页面HTML结构
├── styles.css          # 所有样式定义
├── script.js           # 颜色提取、处理和应用逻辑
└── README.md           # 项目说明文档
```

### 主要函数说明

#### 颜色提取相关
- `extractColorsFromThemeImage(imageUrl)`：从主题图片中提取两种颜色
- `rgbToHsl(r, g, b)`：RGB转HSL
- `hslToRgb(h, s, l)`：HSL转RGB
- `rgbToHex(r, g, b)`：RGB转十六进制
- `hexToRgb(hex)`：十六进制转RGB
- `applyMorandiMapping(color)`：应用莫兰迪色调映射
- `lightenColor(hexColor, amount)`：调淡颜色

#### 颜色应用相关
- `updateColors(strongColor, softColor)`：将提取的颜色应用到长图各个元素
- `updateCardColors(strongColor)`：更新名片区域颜色
- `updateMindmapColors(strongColor, lightenedSoftColor)`：更新思维导图颜色

#### 代码生成相关
- `generateColorLogicCode(...)`：生成取色逻辑代码
- `generatePaletteJson(...)`：生成Palette JSON代码
- `generateMorandiColorsList()`：生成莫兰迪色系颜色列表

#### 模式切换相关
- `switchToIphoneMode()`：切换到iPhone样机模式
- `switchToH5Mode()`：切换到H5长图模式

#### 其他功能
- `handleFileUpload(file)`：处理文件上传
- `generatePlaceholderQRCode()`：生成占位二维码

## 使用说明

### 基本使用流程
1. **打开网站**：在浏览器中打开 `index.html` 文件
2. **上传图片**：
   - 方式1：点击"选择文件"按钮，选择本地图片
   - 方式2：将图片拖拽到上传区域
3. **查看配色**：
   - 系统自动提取颜色并应用到长图
   - 左侧显示当前配色（深色和浅色）
4. **查看代码**：
   - 右侧上方卡片显示取色逻辑代码
   - 右侧下方卡片显示Palette JSON
5. **切换预览模式**：
   - 点击左侧切换按钮的"iPhone"部分：显示样机模式
   - 点击左侧切换按钮的"H5长图"部分：显示纯长图模式
6. **浏览莫兰迪色系**：
   - 在左侧"莫兰迪色系颜色展示"卡片中滚动浏览所有颜色

### 最佳实践
- **图片选择**：建议上传色彩丰富、对比度适中的图片
- **图片大小**：建议不超过5MB，以获得更好的处理性能
- **图片格式**：支持JPG、PNG、GIF等常见格式
- **预览模式**：
  - iPhone模式：适合查看完整的移动端效果
  - H5长图模式：适合查看纯内容效果，方便截图

## 浏览器兼容性

- ✅ Chrome（推荐）
- ✅ Firefox
- ✅ Safari
- ✅ Edge
- ⚠️ IE11及以下版本不支持（使用了ES6+语法和Canvas API）

## 注意事项

1. **固定颜色**：某些颜色区域（如产品卖点序号、副标题文字）不会随提取的颜色变化
2. **颜色调整**：系统会自动调整提取的颜色以确保深色和浅色的对比度
3. **莫兰迪映射**：所有提取的颜色都会应用莫兰迪色调映射，确保视觉和谐
4. **图片处理**：图片会被缩放到200px以内进行处理，以提高性能
5. **跨域问题**：如果图片来自其他域名，可能会遇到跨域限制

## 未来规划

### 功能扩展
- [ ] 支持多张图片上传和对比
- [ ] 支持手动调整提取的颜色
- [ ] 支持导出配色方案为CSS变量文件
- [ ] 支持保存和加载配色方案
- [ ] 支持更多预览设备（iPad、Android等）

### 性能优化
- [ ] 使用Web Worker处理图片，避免阻塞主线程
- [ ] 添加图片压缩功能
- [ ] 优化大图片的处理速度

### UI/UX改进
- [ ] 添加加载动画
- [ ] 添加错误提示
- [ ] 优化移动端体验
- [ ] 添加键盘快捷键支持

## 更新日志

### v1.0.0 (当前版本)
- ✅ 实现图片上传功能（点击和拖拽）
- ✅ 实现颜色提取算法
- ✅ 实现莫兰迪色调映射
- ✅ 实现配色规则应用
- ✅ 实现iPhone样机模式
- ✅ 实现H5长图模式
- ✅ 实现代码输出功能
- ✅ 实现莫兰迪色系展示
- ✅ 实现思维导图样式
- ✅ 实现名片样式

## 许可证

本项目仅供学习和参考使用。

## 联系方式

如有问题或建议，欢迎反馈。
